<div layout="column" ng-cloak>
  <md-toolbar ng-if="!vm.hideToolbar" class="md-parimary">
    <div class="md-toolbar-tools">
      <h2 class="md-flex" data-translate="hackathonApp.challengeslist.home.title"></h2>
      <div flex></div>
      <md-button class="md-fab md-mini" aria-label="Search" ng-click="vm.toggleOpenSearch()">
        <md-icon class="material-icons" ng-show="!vm.openSearch">search</md-icon>
        <md-icon class="material-icons" ng-show="vm.openSearch">close</md-icon>
      </md-button>
    </div>
  </md-toolbar>

  <div ng-show="vm.openSearch" flex layout="row" layout-xs="column">
    <md-input-container class="md-block" flex-gt-sm>
      <label data-translate="hackathonApp.search.name"></label>
      <input ng-model="vm.challengeSearch.name" ng-change="vm.querySearchName()" ng-model-options="{ debounce: 500 }" style="color:black !important;">
    </md-input-container>
    <md-input-container>
      <label data-translate="hackathonApp.search.startDate"></label>
      <md-datepicker ng-model="vm.challengeSearch.eventStartTime" ng-change="vm.querySearchName()"></md-datepicker>
    </md-input-container>
    <md-input-container>
      <label data-translate="hackathonApp.search.endDate"></label>
      <md-datepicker ng-model="vm.challengeSearch.eventEndTime" ng-change="vm.querySearchName()"></md-datepicker>
    </md-input-container>
  </div>

  <!-- No challenge -->
  <div class="row" ng-if="vm.hasNoChallenge" class="text-center">
    <div class="col-md-3"></div>
    <div class="col-md-6 text-center">
      <uib-alert type="warning">
        <span data-translate="hackathonApp.challengeslist.noChallenge"></span>
      </uib-alert>
      <div>
        <img src='content/images/default/no-challenge.png' class="img img-responsive">
      </div>

    </div>
    <div class="col-md-3"></div>
  </div>

  <md-content flex layout-padding infinite-scroll="vm.loadPage(vm.page + 1)" infinite-scroll-disabled="vm.page >= vm.links['last']">

    <div class="col-sm-12 col-md-4 repeated-item" ng-repeat="challenge in vm.challenges">
      <md-card class="challenge-container">
        <img md-card-image ng-src="{{challenge.bannerUrl64 ? challenge.bannerUrl64 : '/content/images/svg/index.square-circle-preloader.svg'}}"
          ui-sref="challengeslist-detail({id:challenge.id})" class='md-card-image' ng-class="{'img-grey': vm.getApplicationStatus(challenge) == 'INACTIVE'}"
          alt="">

        <md-card-title class='challenge-title' ui-sref="challengeslist-detail({id:challenge.id})">{{challenge.name}}</md-card-title>
        <md-card-subtitle class='challenge-owner' ui-sref="challengeslist-detail({id:challenge.id})">{{company.name}}</md-card-subtitle>
        <div class="line"></div>

        <md-card-content class='challenge-content' ui-sref="challengeslist-detail({id:challenge.id})">
          <md-list ng-switch="challenge.info.status">
            <md-list-item>
              <i class="challenge-icon material-icons w3-text-indigo">date_range</i> {{challenge.info.eventStartTime | date:'MMM dd, yyyy'}} - {{challenge.info.eventEndTime | date:'MMM
              dd, yyyy'}}
            </md-list-item>
            <md-list-item>
              <span class="list-item">
                <i class="material-icons challenge-icon w3-text-red">place</i>
                <span>{{challenge.info.location}}</span>
              </span>
            </md-list-item>
            <md-list-item>
              <span class="list-item">
                <i class="material-icons challenge-icon w3-text-indigo">stars</i>
                <span>{{challenge.info.prize}}</span>
              </span>
            </md-list-item>
            <md-list-item ng-switch-when="ACTIVE">
              <i class="challenge-icon material-icons w3-text-orange">alarm</i>{{challenge.timeLeft}}
            </md-list-item>
            <md-list-item ng-switch-when="INACTIVE">
              <i class="challenge-icon material-icons w3-text-red">alarm_off</i>
              <span data-translate="hackathonApp.challengesDetails.timeUp"></span>
            </md-list-item>
          </md-list>

        </md-card-content>

        <md-card-actions ng-switch="vm.getApplicationStatus(challenge)" has-authority-except="ROLE_HOST">

          <button class="btn btn-block challenge-cta btn-active" ng-switch-when="ACTIVE" ng-switch="vm.isAuthenticated()">
            <a href="#" ui-sref="login-signup" ng-switch-when="false" data-translate="hackathonApp.applicationStatus.apply"></a>
            <a href="#" ui-sref="complete-profile({id: challenge.id})" ng-if="vm.userInfo.status!='PROFILE_COMPLETE'" ng-switch-when="true"
              data-translate="hackathonApp.applicationStatus.apply"></a>
            <a href="#" ui-sref="team({id: challenge.id})" ng-if="vm.userInfo.status=='PROFILE_COMPLETE'" ng-switch-when="true" data-translate="hackathonApp.applicationStatus.apply"></a>
          </button>

          <button class="btn btn-block challenge-cta btn-applied" ng-click="vm.getApplicationId(challenge.id)" ui-sref="applicationslist-detail({id:vm.applicationId})"
            ng-switch-when="APPLIED">
            <a href="#" data-translate="hackathonApp.applicationStatus.applied"></a>
          </button>

          <button class="btn btn-block challenge-cta btn-inactive" ng-switch-when="INACTIVE" disabled>
            <a href="#" data-translate="hackathonApp.applicationStatus.close"></a>
          </button>
        </md-card-actions>
      </md-card>
    </div>

    <md-button class="md-raised md-primary" ng-show="vm.page < vm.links['last']" style="position: fixed; bottom: 0px; margin:auto; left:50%;z-index:100000;"
      ng-click="vm.gotoBottom();vm.loadPage(vm.page + 1);">
      <md-icon class="material-icons">arrow_downward</md-icon>
      <span data-translate="hackathonApp.search.pull"></span>
    </md-button>
  </md-content>

</div>